import{a as p}from"./vendor-2s9xPmg-.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))c(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&c(l)}).observe(document,{childList:!0,subtree:!0});function s(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(o){if(o.ep)return;o.ep=!0;const a=s(o);fetch(o.href,a)}})();const W="https://dummyjson.com",f={CATEGORIES:"products/category-list",PRODUCTS:"products",CATEGORY:"products/category/",SEARCH:"products/search"},m=12,r={QUERY:"All",PAGE:1,FLAG:"All",ID:1},y={cart:0,wishlist:0},u={light:"light",dark:"dark"};p.defaults.baseURL=W;async function x(){return(await p.get(f.CATEGORIES)).data}async function D(){const t=(r.PAGE-1)*m;return(await p.get(`${f.PRODUCTS}?limit=${m}&skip=${t}`)).data}async function H(){const t=(r.PAGE-1)*m;return(await p.get(`${f.CATEGORY}${r.QUERY}?limit=${m}&skip=${t}`)).data}async function U(){const t=(r.PAGE-1)*m;return(await p.get(`${f.SEARCH}?q=${r.QUERY}&limit=${m}&skip=${t}`)).data}async function A(t){return(await p.get(`${f.PRODUCTS}/${t}`)).data}const n={categoriesList:document.querySelector("ul.categories"),productsList:document.querySelector("ul.products"),notFoundBlock:document.querySelector("div.not-found"),modal:document.querySelector("div.modal"),modalProduct:document.querySelector("div.modal-product"),closeModalBtn:document.querySelector(".modal__close-btn"),loadMoreBtn:document.querySelector(".load-more-btn"),searchForm:document.querySelector(".search-form"),clearSearchFormBtn:document.querySelector(".search-form__btn-clear"),addToCardBtn:document.querySelector(".modal-product__btn--cart"),addToWishlistBtn:document.querySelector(".modal-product__btn--wishlist"),cartCounter:document.querySelector("[data-cart-count]"),wishlistCounter:document.querySelector("[data-wishlist-count]"),themeToggleBtn:document.querySelector(".theme-toggle-btn")};function N(t){const s=["All",...t].map(c=>`<li class="categories__item">
      <button class="categories__btn" type="button">${c}</button>
    </li>`).join("");n.categoriesList.innerHTML=s}function T(t){const e=t.map(({id:s,thumbnail:c,description:o,title:a,brand:l,category:_,price:C})=>`<li class="products__item" data-id="${s}">
    <img class="products__image" src="${c}" alt="${o}"/>
    <p class="products__title">${a}</p>
    <p class="products__brand"><span class="products__brand--bold">Brand: </span>${l||"no brand"}</p>
    <p class="products__category">Category: ${_}</p>
    <p class="products__price">Price: ${C}$</p>
 </li>`).join("");n.productsList.insertAdjacentHTML("beforeend",e)}function Y(t){const{id:e,images:s,title:c,description:o,tags:a,price:l,shippingInformation:_,returnPolicy:C}=t,O=`<img class="modal-product__img" src="${s[0]}" alt="${c}" />
      <div class="modal-product__content" data-id="${e}">
        <p class="modal-product__title">${c}</p>
        <ul class="modal-product__tags">${a}</ul>
        <p class="modal-product__description">${o}</p>
        <p class="modal-product__shipping-information">Shipping: ${_}</p>
        <p class="modal-product__return-policy">Return Policy: ${C}</p>
        <p class="modal-product__price">Price: ${l}$</p>
      </div>`;n.modalProduct.innerHTML=O}const i={cart:"cart",wishlist:"wishlist",theme:"theme"};function w(){try{const t=localStorage.getItem(i.theme);return t?JSON.parse(t):u.light}catch(t){return console.error(`Error getting theme from LocalStorage: ${t}`),u.light}}function L(t,e){try{localStorage.setItem(t,JSON.stringify(e))}catch(s){console.error(`Error saving to LocalStorage: ${s}`)}}function h(t){try{const e=localStorage.getItem(t);return e?JSON.parse(e):[]}catch(e){return console.error(`Error loading from LocalStorage: ${e}`),[]}}function b(t){return h(t).some(s=>s===r.ID)}function $(t){const e=h(t);e.some(c=>c===r.ID)||(e.push(r.ID),L(t,e))}function B(t){const e=h(t),s=e.findIndex(o=>o===r.ID);if(s===-1)return;const c=e.filter(o=>o!==e[s]);L(t,c)}async function g(){try{let t=Q();const{products:e,total:s}=await t();e.length===0?J():(T(e),j(s))}catch(t){console.error(`Get products error: ${t}`)}}function Q(){let t;switch(r.FLAG){case"All":t=D;break;case"Category":t=H;break;case"Search":t=U;break}return t}function j(t){Math.ceil(t/m)>r.PAGE?n.loadMoreBtn.classList.remove("is-hidden"):n.loadMoreBtn.classList.add("is-hidden")}function J(){n.notFoundBlock.classList.add("not-found--visible")}function S(){n.productsList.innerHTML=""}function K(t){const e=document.querySelector(".categories__btn--active");e&&e.classList.remove("categories__btn--active"),t.classList.add("categories__btn--active")}function F(){const t=document.querySelector(".categories__btn--active");t&&t.classList.remove("categories__btn--active")}function E(){n.notFoundBlock.classList.remove("not-found--visible")}function k(){n.loadMoreBtn.classList.add("is-hidden")}async function V(t){const e=h(t),c=(await Promise.allSettled(e.map(o=>A(o)))).filter(o=>o.status==="fulfilled").map(o=>o.value);T(c)}function P(){G(),I()}function G(){const t=h(i.cart);y.cart=t.length,n.cartCounter.textContent=y.cart}function I(){const t=h(i.wishlist);y.wishlist=t.length,n.wishlistCounter.textContent=y.wishlist}function rt(){const e=w()===u.light?u.dark:u.light;n.themeToggleBtn.innerHTML=e===u.light?"üåô":"‚òÄÔ∏è",document.body.dataset.theme=e,L(i.theme,e)}const d={addToCart:"Add to Cart",removeFromCart:"Remove from Cart",addToWishlist:"Add to Wishlist",removeFromWishlist:"Remove from Wishlist"};n.addToCardBtn.addEventListener("click",z);n.addToWishlistBtn.addEventListener("click",Z);function X(){n.modal.classList.add("modal--is-open"),document.body.style.overflow="hidden",window.addEventListener("keydown",q),n.modal.addEventListener("click",M),r.ID=n.modal.querySelector(".modal-product__content").dataset.id,et(),tt()}function R(){n.modal.classList.remove("modal--is-open"),document.body.style.overflow="",window.removeEventListener("keydown",q),n.modal.removeEventListener("click",M)}function z(t){const e=t.target;e.textContent===d.addToCart?($(i.cart),e.textContent=d.removeFromCart):(B(i.cart),e.textContent=d.addToCart),G()}function Z(t){const e=t.target;e.textContent===d.addToWishlist?($(i.wishlist),e.textContent=d.removeFromWishlist):(B(i.wishlist),e.textContent=d.addToWishlist),I()}function q(t){t.code==="Escape"&&R()}function M(t){t.target===n.modal&&R()}function tt(){const t=b(i.wishlist);n.addToWishlistBtn.textContent=t?d.removeFromWishlist:d.addToWishlist}function et(){const t=b(i.cart);n.addToCardBtn.textContent=t?d.removeFromCart:d.addToCart}async function nt(){v(),P();try{const t=await x();N(t)}catch(t){console.error(`Get categories error: ${t}`)}await g()}async function st(){v(),P(),V(i.wishlist)}async function ct(){v(),P()}async function at(t){const e=t.target.closest(".categories__btn");e&&(r.PAGE=1,r.QUERY=e.textContent,r.QUERY==="All"?r.FLAG="All":r.FLAG="Category",K(e),S(),E(),k(),await g())}async function it(t){const e=t.target.closest("li.products__item");if(!e)return;const s=e.dataset.id;try{const c=await A(s);Y(c)}catch(c){console.error(`Get product error: ${c}`)}X()}async function dt(t){t.preventDefault();const s=new FormData(t.target).get("searchValue").trim();if(!s){alert("type something");return}F(),S(),E(),k(),r.QUERY=s,r.PAGE=1,r.FLAG="Search",g()}async function lt(){n.searchForm.reset(),r.QUERY="All",r.PAGE=1,r.FLAG="All",S(),E(),F(),await g()}async function ut(){r.PAGE+=1,await g()}function v(){const t=w();document.body.setAttribute("data-theme",t),document.body.dataset.theme=t,n.themeToggleBtn.innerHTML=t===u.light?"üåô":"‚òÄÔ∏è"}export{nt as a,at as b,R as c,ut as d,dt as e,lt as f,ct as g,it as h,st as i,n as r,rt as t};
//# sourceMappingURL=handlers-B1n-pcRR.js.map
