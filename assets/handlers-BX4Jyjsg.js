import{a as p}from"./vendor-2s9xPmg-.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))c(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&c(l)}).observe(document,{childList:!0,subtree:!0});function s(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(o){if(o.ep)return;o.ep=!0;const a=s(o);fetch(o.href,a)}})();const x="https://dummyjson.com",g={CATEGORIES:"products/category-list",PRODUCTS:"products",CATEGORY:"products/category/",SEARCH:"products/search"},m=12,r={QUERY:"All",PAGE:1,FLAG:"All",ID:1,CLOSE_MODAL_CALLBACK:void 0},L={cart:0,wishlist:0},u={light:"light",dark:"dark"};p.defaults.baseURL=x;async function H(){return(await p.get(g.CATEGORIES)).data}async function U(){const t=(r.PAGE-1)*m;return(await p.get(`${g.PRODUCTS}?limit=${m}&skip=${t}`)).data}async function N(){const t=(r.PAGE-1)*m;return(await p.get(`${g.CATEGORY}${r.QUERY}?limit=${m}&skip=${t}`)).data}async function Y(){const t=(r.PAGE-1)*m;return(await p.get(`${g.SEARCH}?q=${r.QUERY}&limit=${m}&skip=${t}`)).data}async function b(t){return(await p.get(`${g.PRODUCTS}/${t}`)).data}const n={categoriesList:document.querySelector("ul.categories"),productsList:document.querySelector("ul.products"),notFoundBlock:document.querySelector("div.not-found"),modal:document.querySelector("div.modal"),modalProduct:document.querySelector("div.modal-product"),closeModalBtn:document.querySelector(".modal__close-btn"),loadMoreBtn:document.querySelector(".load-more-btn"),searchForm:document.querySelector(".search-form"),clearSearchFormBtn:document.querySelector(".search-form__btn-clear"),addToCardBtn:document.querySelector(".modal-product__btn--cart"),addToWishlistBtn:document.querySelector(".modal-product__btn--wishlist"),headerCartCounter:document.querySelector("[data-cart-count]"),headerWishlistCounter:document.querySelector("[data-wishlist-count]"),themeToggleBtn:document.querySelector(".theme-toggle-btn"),cartCounter:document.querySelector("[data-count]"),cartPriceCounter:document.querySelector("[data-price]")};function K(t){const s=["All",...t].map(c=>`<li class="categories__item">
      <button class="categories__btn" type="button">${c}</button>
    </li>`).join("");n.categoriesList.innerHTML=s}function f(t){const e=t.map(({id:s,thumbnail:c,description:o,title:a,brand:l,category:_,price:S})=>`<li class="products__item" data-id="${s}">
    <img class="products__image" src="${c}" alt="${o}"/>
    <p class="products__title">${a}</p>
    <p class="products__brand"><span class="products__brand--bold">Brand: </span>${l||"no brand"}</p>
    <p class="products__category">Category: ${_}</p>
    <p class="products__price">Price: ${S}$</p>
 </li>`).join("");n.productsList.insertAdjacentHTML("beforeend",e)}function Q(t){const{id:e,images:s,title:c,description:o,tags:a,price:l,shippingInformation:_,returnPolicy:S}=t,W=`<img class="modal-product__img" src="${s[0]}" alt="${c}" />
      <div class="modal-product__content" data-id="${e}">
        <p class="modal-product__title">${c}</p>
        <ul class="modal-product__tags">${a}</ul>
        <p class="modal-product__description">${o}</p>
        <p class="modal-product__shipping-information">Shipping: ${_}</p>
        <p class="modal-product__return-policy">Return Policy: ${S}</p>
        <p class="modal-product__price">Price: ${l}$</p>
      </div>`;n.modalProduct.innerHTML=W}const i={cart:"cart",wishlist:"wishlist",theme:"theme"};function $(){try{const t=localStorage.getItem(i.theme);return t?JSON.parse(t):u.light}catch(t){return console.error(`Error getting theme from LocalStorage: ${t}`),u.light}}function A(t,e){try{localStorage.setItem(t,JSON.stringify(e))}catch(s){console.error(`Error saving to LocalStorage: ${s}`)}}function h(t){try{const e=localStorage.getItem(t);return e?JSON.parse(e):[]}catch(e){return console.error(`Error loading from LocalStorage: ${e}`),[]}}function B(t){return h(t).some(s=>s===r.ID)}function F(t){const e=h(t);e.some(c=>c===r.ID)||(e.push(r.ID),A(t,e))}function O(t){const e=h(t),s=e.findIndex(o=>o===r.ID);if(s===-1)return;const c=e.filter(o=>o!==e[s]);A(t,c)}async function C(){try{let t=j();const{products:e,total:s}=await t();e.length===0?V():(f(e),J(s))}catch(t){console.error(`Get products error: ${t}`)}}function j(){let t;switch(r.FLAG){case"All":t=U;break;case"Category":t=N;break;case"Search":t=Y;break}return t}function J(t){Math.ceil(t/m)>r.PAGE?n.loadMoreBtn.classList.remove("is-hidden"):n.loadMoreBtn.classList.add("is-hidden")}function V(){n.notFoundBlock.classList.add("not-found--visible")}function E(){n.productsList.innerHTML=""}function X(t){const e=document.querySelector(".categories__btn--active");e&&e.classList.remove("categories__btn--active"),t.classList.add("categories__btn--active")}function M(){const t=document.querySelector(".categories__btn--active");t&&t.classList.remove("categories__btn--active")}function P(){n.notFoundBlock.classList.remove("not-found--visible")}function k(){n.loadMoreBtn.classList.add("is-hidden")}async function y(t){const e=h(t);return(await Promise.allSettled(e.map(o=>b(o)))).filter(o=>o.status==="fulfilled").map(o=>o.value)}function w(t){const e=t.length;n.cartCounter.textContent=e;let s=0;t.map(c=>s+=c.price),n.cartPriceCounter.textContent=`$${s.toFixed(2)}`}function T(){G(),I()}function G(){const t=h(i.cart);L.cart=t.length,n.headerCartCounter.textContent=L.cart}function I(){const t=h(i.wishlist);L.wishlist=t.length,n.headerWishlistCounter.textContent=L.wishlist}function nt(){const e=$()===u.light?u.dark:u.light;n.themeToggleBtn.innerHTML=e===u.light?"üåô":"‚òÄÔ∏è",document.body.dataset.theme=e,A(i.theme,e)}const d={addToCart:"Add to Cart",removeFromCart:"Remove from Cart",addToWishlist:"Add to Wishlist",removeFromWishlist:"Remove from Wishlist"};n.addToCardBtn.addEventListener("click",Z);n.addToWishlistBtn.addEventListener("click",tt);function z(){n.modal.classList.add("modal--is-open"),document.body.style.overflow="hidden",window.addEventListener("keydown",q),n.modal.addEventListener("click",D),r.ID=n.modal.querySelector(".modal-product__content").dataset.id,ot(),et()}function R(){n.modal.classList.remove("modal--is-open"),document.body.style.overflow="",window.removeEventListener("keydown",q),n.modal.removeEventListener("click",D),r.CLOSE_MODAL_CALLBACK&&r.CLOSE_MODAL_CALLBACK()}function Z(t){const e=t.target;e.textContent===d.addToCart?(F(i.cart),e.textContent=d.removeFromCart):(O(i.cart),e.textContent=d.addToCart),G()}function tt(t){const e=t.target;e.textContent===d.addToWishlist?(F(i.wishlist),e.textContent=d.removeFromWishlist):(O(i.wishlist),e.textContent=d.addToWishlist),I()}function q(t){t.code==="Escape"&&R()}function D(t){t.target===n.modal&&R()}function et(){const t=B(i.wishlist);n.addToWishlistBtn.textContent=t?d.removeFromWishlist:d.addToWishlist}function ot(){const t=B(i.cart);n.addToCardBtn.textContent=t?d.removeFromCart:d.addToCart}async function st(){v(),T();try{const t=await H();K(t)}catch(t){console.error(`Get categories error: ${t}`)}await C()}async function ct(){v(),T();const t=await y(i.wishlist);f(t),r.CLOSE_MODAL_CALLBACK=async()=>{n.productsList.innerHTML="";const e=await y(i.wishlist);f(e)}}async function at(){v(),T();const t=await y(i.cart);f(t),w(t),r.CLOSE_MODAL_CALLBACK=async()=>{n.productsList.innerHTML="";const e=await y(i.cart);f(e),w(e)}}async function it(t){const e=t.target.closest(".categories__btn");e&&(r.PAGE=1,r.QUERY=e.textContent,r.QUERY==="All"?r.FLAG="All":r.FLAG="Category",X(e),E(),P(),k(),await C())}async function dt(t){const e=t.target.closest("li.products__item");if(!e)return;const s=e.dataset.id;try{const c=await b(s);Q(c)}catch(c){console.error(`Get product error: ${c}`)}z()}async function lt(t){t.preventDefault();const s=new FormData(t.target).get("searchValue").trim();if(!s){alert("type something");return}M(),E(),P(),k(),r.QUERY=s,r.PAGE=1,r.FLAG="Search",C()}async function ut(){n.searchForm.reset(),r.QUERY="All",r.PAGE=1,r.FLAG="All",E(),P(),M(),await C()}async function mt(){r.PAGE+=1,await C()}function v(){const t=$();document.body.setAttribute("data-theme",t),document.body.dataset.theme=t,n.themeToggleBtn.innerHTML=t===u.light?"üåô":"‚òÄÔ∏è"}export{st as a,it as b,R as c,mt as d,lt as e,ut as f,at as g,dt as h,ct as i,n as r,nt as t};
//# sourceMappingURL=handlers-BX4Jyjsg.js.map
